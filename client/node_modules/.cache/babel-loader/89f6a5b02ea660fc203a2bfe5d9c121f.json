{"ast":null,"code":"import _regeneratorRuntime from\"/home/sab4/Desktop/twitter-clone/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/sab4/Desktop/twitter-clone/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/sab4/Desktop/twitter-clone/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Avatar from'@material-ui/core/Avatar';import'./Home.css';import ImageOutlinedIcon from'@material-ui/icons/ImageOutlined';import PollOutlinedIcon from'@material-ui/icons/PollOutlined';import Axios from'axios';import Post from'./Post';import Poll from'./Poll';import{useSelector}from\"react-redux\";import Modal from'@material-ui/core/Modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Home(){//post  \nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),postsArr=_useState6[0],setPostsArr=_useState6[1];//image\nvar _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),fileData=_useState8[0],setFileData=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),images=_useState10[0],setFile=_useState10[1];//modal\nvar _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),open=_useState12[0],setOpen=_useState12[1];//poll\nvar _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),title=_useState14[0],setTitle=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),option1=_useState16[0],setOption1=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),option2=_useState18[0],setOption2=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),option3=_useState20[0],setOption3=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),poll=_useState22[0],setPoll=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),polls=_useState24[0],setPolls=_useState24[1];//load\nvar _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),load=_useState26[0],setLoad=_useState26[1];//select image\nvar onChangeFile=function onChangeFile(e){setFileData(e.target.files[0]);setFile(e.target.value);};//modal\nvar handleOpen=function handleOpen(){setOpen(true);};var handleClose=function handleClose(){setOpen(false);};var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;//get data\nuseEffect(function(){var flag=true;Axios.get(\"http://localhost:3001/pollsData\").then(function(res){if(flag){setPolls(res.data);}});Axios.get(\"http://localhost:3001/read\").then(function(res){if(flag){setPostsArr(res.data);}});if(load){setTimeout(function(){setLoad(false);},1500);}return function(){return flag=false;};},[load]);var AddPosts2=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var user,formData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:user=userInfo.username;formData=new FormData();formData.append(\"post\",post);formData.append(\"user\",user);e.preventDefault();_context.next=7;return Axios.post(\"http://localhost:3001/insert2\",formData).then(function(){setPost('');setLoad(true);}).catch(function(err){console.log(err);});case 7:case\"end\":return _context.stop();}}},_callee);}));return function AddPosts2(_x){return _ref.apply(this,arguments);};}();var AddPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var user,formData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:user=userInfo.username;formData=new FormData();formData.append(\"post\",post);formData.append(\"image\",fileData);formData.append(\"user\",user);e.preventDefault();_context2.next=8;return Axios.post(\"http://localhost:3001/insert\",formData).then(function(){setFileData('');setLoad(true);}).catch(function(err){console.log(err);});case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function AddPosts(_x2){return _ref2.apply(this,arguments);};}();var AddPoll=function AddPoll(e){e.preventDefault();setOpen(false);Axios.post(\"http://localhost:3001/poll\",{title:title,option1:option1,option2:option2,option3:option3}).then(function(){return setLoad(true);}).catch(function(err){console.log(err);});};var user=userInfo.username;var body=/*#__PURE__*/_jsxs(\"div\",{className:\"modal_body\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Make a poll\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal_question\",children:/*#__PURE__*/_jsx(\"textarea\",{onChange:function onChange(e){return setTitle(e.target.value);},wrap:\"soft\",placeholder:\"Ask a question...\",style:{resize:'none'}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal_body_cont\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){setOption1(e.target.value);},type:\"text\",placeholder:\"Choice 1\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){setOption2(e.target.value);},type:\"text\",placeholder:\"Choice 2\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){setOption3(e.target.value);},type:\"text\",placeholder:\"Choice 3\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal_button\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:AddPoll,children:\"Tweet\"})})]});return/*#__PURE__*/_jsxs(\"div\",{className:\"home\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home_cont\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"homefile_title\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Home\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"home__profile_cont\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home__profile\",children:[/*#__PURE__*/_jsx(Avatar,{src:userInfo===null||userInfo===void 0?void 0:userInfo.pic,style:{width:'50px',height:'50px'}}),/*#__PURE__*/_jsx(\"div\",{className:\"home__profile_input\",children:/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setPost(e.target.value);},type:\"text\",placeholder:\"What's happening?\"})})]}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"home__actions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home__actions_icons\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home__uploadImage\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"postImage\",children:/*#__PURE__*/_jsx(ImageOutlinedIcon,{style:{color:'rgba(29,161,242,1.00)',cursor:'pointer'}})}),/*#__PURE__*/_jsx(\"input\",{id:\"postImage\",onChange:onChangeFile,name:\"file\",type:\"file\"})]}),/*#__PURE__*/_jsx(PollOutlinedIcon,{onClick:handleOpen,style:{color:'rgba(29,161,242,1.00)',cursor:'pointer'}})]}),(post||fileData)&&/*#__PURE__*/_jsx(\"button\",{onClick:fileData?AddPosts:AddPosts2,type:\"submit\",children:\"Tweet\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reverse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Posts\",children:postsArr.map(function(value){return/*#__PURE__*/_jsx(Post,{id:value._id,post:value.posting,image:value.image,user:user},value._id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"Polls\",children:polls.map(function(val){return/*#__PURE__*/_jsx(Poll,{id:val._id,title:val.title,option1:val.option1,option2:val.option2,option3:val.option3},val._id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal\",children:/*#__PURE__*/_jsx(Modal,{open:open,onClose:handleClose,\"aria-labelledby\":\"simple-modal-title\",\"aria-describedby\":\"simple-modal-description\",children:body})})]})]});}export default Home;","map":{"version":3,"sources":["/home/sab4/Desktop/twitter-clone/client/src/components/Home.js"],"names":["React","useState","useEffect","Avatar","ImageOutlinedIcon","PollOutlinedIcon","Axios","Post","Poll","useSelector","Modal","Home","post","setPost","users","setUsers","postsArr","setPostsArr","fileData","setFileData","images","setFile","open","setOpen","title","setTitle","option1","setOption1","option2","setOption2","option3","setOption3","poll","setPoll","polls","setPolls","load","setLoad","onChangeFile","e","target","files","value","handleOpen","handleClose","userLogin","state","userInfo","flag","get","then","res","data","setTimeout","AddPosts2","user","username","formData","FormData","append","preventDefault","catch","err","console","log","AddPosts","AddPoll","body","resize","pic","width","height","color","cursor","map","_id","posting","image","val"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react'\nimport Avatar from '@material-ui/core/Avatar';\nimport './Home.css'\nimport ImageOutlinedIcon from '@material-ui/icons/ImageOutlined';\nimport PollOutlinedIcon from '@material-ui/icons/PollOutlined';\nimport Axios from 'axios'\nimport Post from './Post'\nimport Poll from './Poll'\nimport { useSelector } from \"react-redux\";\nimport Modal from '@material-ui/core/Modal';\nfunction Home() {\n    //post  \n\n\n    const [post, setPost]=useState(\"\");\n    const [users, setUsers]= useState([])\n    const[postsArr, setPostsArr] = useState([])\n    //image\n    const [fileData, setFileData] = useState('');\n    const [images, setFile] = useState(\"\");\n    //modal\n    const [open, setOpen] = useState(false);\n    //poll\n    const [title, setTitle] = useState('')\n    const [option1, setOption1] = useState('')\n    const [option2, setOption2] = useState('')\n    const [option3, setOption3] = useState('')\n    const[poll,setPoll] = useState([])\n    const[polls,setPolls] = useState([])\n    //load\n    const [load, setLoad] = useState(false);\n\n//select image\nconst onChangeFile = (e) =>{\n    setFileData(e.target.files[0]);\n    setFile(e.target.value);\n}\n\n //modal\n    const handleOpen = () => {\n      setOpen(true);\n    };\n    const handleClose = () => {\n      setOpen(false);\n    };\n\n    const userLogin = useSelector((state) => state.userLogin);\n    const { userInfo } = userLogin;\n   //get data\n   useEffect(() => {\n    \n      let  flag = true\n       Axios.get(\"http://localhost:3001/pollsData\", )\n           .then((res) => {\n               if (flag) {\n                   setPolls(res.data);\n               }\n           })\n\n       Axios.get(\"http://localhost:3001/read\", )\n           .then((res) => {\n               if (flag) {\n                   setPostsArr(res.data);\n               }\n           })\n       \n           if(load) {\n\n            setTimeout(() => {\n              setLoad(false);\n            }, 1500)\n          }\n       return () => flag = false\n   }, [load])\n\n     \n    const AddPosts2 = async (e)  =>{\n        const user = userInfo.username\n \n        const formData = new FormData();\n        formData.append(\"post\", post)\n        formData.append(\"user\", user)\n        e.preventDefault()\n\n        await Axios.post(\"http://localhost:3001/insert2\",formData)\n        .then(() => {\n            setPost('');\n            setLoad(true);\n          })\n\n        .catch((err)=>{\n            console.log(err);\n        })\n    }\n\n    const AddPosts = async (e)  =>{\n        const user = userInfo.username\n  \n        const formData = new FormData();\n        formData.append(\"post\", post)\n        formData.append(\"image\", fileData)\n        formData.append(\"user\", user)\n        e.preventDefault()\n       \n       await Axios.post(\"http://localhost:3001/insert\",formData)\n       .then(() => {\n        setFileData('');\n        setLoad(true);\n      })\n       .catch((err)=>{\n           console.log(err);\n       })\n\n    }\n\n    const AddPoll =  (e)  =>{\n   \n        e.preventDefault()\n        setOpen(false)\n        Axios.post(\"http://localhost:3001/poll\",{\n           title:title,\n           option1:option1,\n           option2:option2,\n           option3:option3,\n        })\n      \n    .then(()=>setLoad(true))\n       .catch((err)=>{\n           console.log(err);\n       })\n\n    }\n    const user = userInfo.username\n    \n    const body = (\n        <div className=\"modal_body\">\n            <h1>Make a poll</h1>\n            <div className=\"modal_question\">\n                    <textarea\n                    onChange={(e)=>setTitle(e.target.value)}\n                    wrap=\"soft\" \n                    placeholder='Ask a question...' \n                    style={{resize:'none'}}></textarea>\n            </div>\n            <div className=\"modal_body_cont\">\n                <input onChange={(e)=>{setOption1(e.target.value)}} type=\"text\" placeholder='Choice 1' />\n                <input onChange={(e)=>{setOption2(e.target.value)}} type=\"text\" placeholder='Choice 2' />\n                <input onChange={(e)=>{setOption3(e.target.value)}} type=\"text\" placeholder='Choice 3' />\n            </div>\n            <div className=\"modal_button\">\n                <button type='submit' onClick={AddPoll}>Tweet</button>\n            </div>\n       \n        </div>\n      );\n    return (\n        <div className='home'>\n        <div className='home_cont'>\n\n            <div className=\"homefile_title\">\n                <h3>Home</h3>\n            </div>\n            \n            <div className=\"home__profile_cont\">\n            <div className=\"home__profile\">\n                <Avatar src={userInfo?.pic} style={{width:'50px',height:'50px'}} />\n                <div className=\"home__profile_input\">\n                    <input\n                    onChange={(e)=>setPost(e.target.value)}\n                    type=\"text\"  \n                    placeholder=\"What's happening?\"/>\n                </div>\n\n                </div>\n\n                <form>\n                <div className=\"home__actions\">\n                    <div className=\"home__actions_icons\">\n                    <div className=\"home__uploadImage\">\n                        <label htmlFor=\"postImage\">\n                            <ImageOutlinedIcon style={{color:'rgba(29,161,242,1.00)',cursor:'pointer'}}/>\n                        </label>\n                        <input id=\"postImage\" \n                        onChange={onChangeFile} \n                        name=\"file\" \n                        type=\"file\" \n                        />\n\n                    </div>\n                   \n                        <PollOutlinedIcon onClick={handleOpen} style={{color:'rgba(29,161,242,1.00)',cursor:'pointer'}}/>\n                    </div>\n                  {(post || fileData)  &&  <button onClick={fileData ? AddPosts : AddPosts2} type='submit'>Tweet</button>}\n                </div>\n                </form>\n            </div>\n            </div>\n            <div className=\"reverse\">\n\n            <div className=\"Posts\">\n             {postsArr.map((value)=>{\n                  return (\n                      <Post\n                      key={value._id}\n                      id={value._id}\n                      post={value.posting}\n                      image={value.image}\n                      user={user}\n                      />\n                  )\n              })}\n            </div>\n\n            <div className=\"Polls\">\n                  {polls.map((val)=>{\n                  return (\n                      <Poll\n                      key={val._id}\n                      id={val._id}\n                      title={val.title}\n                      option1={val.option1}\n                      option2={val.option2}\n                      option3={val.option3}\n                      />\n                  )\n              })}\n            </div>\n            <div className='modal'>\n            <Modal\n                open={open}\n                onClose={handleClose}\n                aria-labelledby=\"simple-modal-title\"\n                aria-describedby=\"simple-modal-description\"\n             >\n                {body}\n            </Modal>\n            </div>\n            </div>\n        </div>\n    )\n}\n\nexport default Home\n"]},"metadata":{},"sourceType":"module"}